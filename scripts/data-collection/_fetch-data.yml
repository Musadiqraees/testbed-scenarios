#!/usr/bin/env ansible-playbook

# The variable 'fetch_dir' must be defined on the command line with ansible-playbook -e fetch_dir=DIR

- name: Fetch data collector data from remote hosts
  hosts: zerops-collector
  tasks:
    - include_role:
        name: ../../roles/zerops-collector
        tasks_from: fetch-data

- name: Fetch sippstress statistics data
  hosts: sippstress
  tasks:
    - synchronize:
        mode: pull
        src: "{{ sipp.load_log_dir }}"
        dest: "{{ fetch_dir }}/{{ inventory_hostname }}/"

- name: Fetch vod client statistics data
  hosts: client
  tasks:
    - synchronize:
        mode: pull
        src: "{{ rtmp.client_log_dir }}"
        dest: "{{ fetch_dir }}/{{ inventory_hostname }}/"
